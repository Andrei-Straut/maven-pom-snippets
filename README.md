# Maven pom snippets

## pom.xml snippets for common project types and use cases

**A collection of useful pom snippets I've gathered while working on several different project types. They can be mixed and matched to get the desired result, for a variety of use cases or projects.**  
  
There's 3 main pom types present:  
- **pom-all:** - applicable for both desktop or web applications  
- **pom-desktop** - desktop or .jar  
- **pom-web** - projects with build artifacts of `.war` type.  

I've tried to keep this as simple and self-explanatory as possible, and as copy-paste ready as I could. Most of the examples here can be readily copy-pasted into an existing pom, and made to work with only minimal configuration needed (user/password where applicable, or paths to target folders or files).  

If you think there's something missing or incorrect, just [contact me](https://www.andreistraut.info/#contact) or better, [open a pull request](https://help.github.com/articles/creating-a-pull-request/). I'll try to review and integrate as fast as possible. I'll try to answer any questions you may have.  

### pom-all-code-coverage-surefire-jacoco

Used to generate code coverage for Java projects, using [Maven Surefire Plugin](http://maven.apache.org/surefire/maven-surefire-plugin/) and [Maven Jacoco Plugin](https://mvnrepository.com/artifact/org.jacoco/jacoco-maven-plugin).  
  
Please note that if the code coverage is supposed to be displayed in a Jenkins instance using the [Jenkins Jacoco plugin](https://wiki.jenkins.io/display/JENKINS/JaCoCo+Plugin), the following restrictions apply:  
- If the Jenkins Jacoco plugin version is `2.0.0` or higher, then the Maven Jacoco Plugin version (the one defined in `pom.xml`) must be `0.7.5` or higher  
- If the Jenkins Jacoco plugin version is `1.0.19` or lower, then the Maven Jacoco Plugin version must be `0.7.4` or lower. See [Jenkins Jacoco plugin](https://wiki.jenkins.io/display/JENKINS/JaCoCo+Plugin)  

For more info, [see the Maven Surefire Plugin page](http://maven.apache.org/surefire/maven-surefire-plugin/) and [Maven Jacoco Plugin page](https://mvnrepository.com/artifact/org.jacoco/jacoco-maven-plugin).  

### pom-all-copy-rename-file
  
Used to copy or rename files during Maven goal execution (sort of like an Ant task), using [Copy Rename Maven Plugin](https://mvnrepository.com/artifact/com.coderplus.maven.plugins/copy-rename-maven-plugin/1.0).  
  
For more info, see the [plugin page](https://mvnrepository.com/artifact/com.coderplus.maven.plugins/copy-rename-maven-plugin/1.0)

### pom-all-module-project

Used for applications consisting of several maven modules (this would be in the pom of the parent application, or so-called parent-pom).  
  
In this example, the application is composed of 2 `.jar` modules, and a `.war`. During the `package` goal execution, the artifacts generated by the modules are copied into the target folder of the parent. The goal is to group all artifacts of the modules into a single folder (for easy distribution, of simply just to have them grouped in a single place), using [Maven Resources Plugin](https://maven.apache.org/plugins/maven-resources-plugin/).  
  
For more info, [see the plugin page](https://maven.apache.org/plugins/maven-resources-plugin/)  

### pom-desktop-runnable-jar

Desktop runnable `.jar` files generated with [Maven Assembly Plugin](http://maven.apache.org/plugins/maven-assembly-plugin/).  
  
Pretty self-explanatory. This snippet generates a single fat `.jar` (jar-with-dependencies), that can then be run as a standalone desktop java application (`java -jar path/to/jar-file`).  
  
For more info, [see the plugin page](http://maven.apache.org/plugins/maven-assembly-plugin/) 
  
### pom-web-npm-script
  
Used to run npm scripts (npm install, build, etc) during Maven goal execution. This pom snippet is specifically used for front-end projects using [npm](https://www.npmjs.com/) but packaged as `.war` files. It allows, for example, to run front-end tests during the build lifecycle, just like, for instance, Surefire does.

Please note, that at least for the first time when Maven is invoked, the `install-node-and-npm` goal of this plugin must be invoked, in order to locally install required tools and dependencies (node and npm). After this, running this goal is optional.

For more info, [see the plugin page](https://mvnrepository.com/artifact/com.github.eirslett/frontend-maven-plugin)  

### pom-web-war-file

Web `.war` files generated with [Maven WAR Plugin](https://maven.apache.org/plugins/maven-war-plugin/index.html).  
  
Pretty self-explanatory. This snippet generates a `.war` file, that can then be deployed to a web server (Glassfish, Wildfly, etc)
  
For more info, [see the plugin page](https://maven.apache.org/plugins/maven-war-plugin/index.html) 

### pom-web-wildfly-deployment
Used for web applications in which auto-deployment (or rather, easier deployment) to a Wildfly server is needed.  
  
Uses  [wildfly maven plugin](https://docs.jboss.org/wildfly/plugins/maven/latest/) to achieve this. The plugin exposes a maven goal `wildfly:deploy` that can be run in order to upload and activate an application to a given Wildfly server. This removes a lot of hassle and allows for quick iterations within a project.  
This plugin is a bit tricky to get right, but once done, it's a breeze. I use it for all web application projects I work on (calld via Jenkins), and it saves me a lot of time.  
  
###### Configuration:
On the machine that will effectively do the deployment, maven's `settings.xml` should contain the credentials for the server. This is done in order to avoid sending the credentials over the wire, or keep them in plaintext in the pom:  
  
In maven's `settings.xml:`  
```xml
<servers>  
    <server>  
        <id>wildfly-server-id</id>  
        <username>DEPLOYMENT_USERNAME</username>  
        <password>DEPLOYMENT_PASSWORD</password>  
    </server>  
</servers>  
```  

The user with deployment rights needs to be present in Wildfly's `mgmt-users.properties`:  
```text
...
DEPLOYMENT_USERNAME=DEPLOYMENT_PASSWORD
...
```
  
`wildfly-server-id` can be anything, as long as it's consistent with the one defined in the pom.  
In order to deploy, I generally call `mvn clean package` to build the war file, then invoke `mvn wildfly:deploy-only` via a separate command to deploy the generated bundle.  
If your build process has no other fancy steps, you can simply call `mvn wildfly:deploy`, which by itself will invoke `package` and generate the bundle.  
  
For more info, [see the plugin page](https://docs.jboss.org/wildfly/plugins/maven/latest/) 




















